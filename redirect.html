<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ouverture WedShoots</title>
  <style>
    body { 
      display: flex; 
      align-items: center; 
      justify-content: center;
      height: 100vh; 
      font-family: sans-serif; 
      text-align: center; 
      padding: 1rem;
    }
    .message {
      max-width: 20rem;
    }
    .button {
      display: inline-block;
      margin-top: 1rem;
      padding: 0.75rem 1.5rem;
      background: #007bff;
      color: #fff;
      text-decoration: none;
      border-radius: 0.25rem;
    }
  </style>
</head>
<body>
  <div class="message">
    <h1>Ouverture de votre album WedShoots</h1>
    <p>Si l’application est installée, elle va s’ouvrir automatiquement.<br>
    Sinon, vous serez redirigé vers la boutique d’applications.</p>
    <p><a id="manualLink" class="button" href="#">Ouvrir manuellement</a></p>
  </div>

  <script>
    // Ton code d'accès
    const accessCode = "ES408879c9";

    // Deep link interne à l'app
    const deepLinkURL = `wedshoots://album?code=${accessCode}`;

    // Fallback Stores
    const iosStoreURL     = "https://apps.apple.com/fr/app/wedshoots/id660256196";
    const androidStoreURL = "https://play.google.com/store/apps/details?id=net.bodas.android.wedshoots&hl=fr";

    // Intent Android
    const androidIntent = 
      `intent://album?code=${accessCode}` +
      `#Intent;scheme=wedshoots;package=net.bodas.android.wedshoots;` +
      `S.browser_fallback_url=${encodeURIComponent(androidStoreURL)};end`;

    // Fonction de redirection principale
    function redirect() {
      const ua = navigator.userAgent || "";
      if (/Android/i.test(ua)) {
        // Android : lance l'intent
        window.location = androidIntent;
      } 
      else if (/iPhone|iPad|iPod/i.test(ua)) {
        // iOS : on tente le schéma custom
        window.location = deepLinkURL;
        // si l'app n'ouvre pas après 1,5s, on redirige vers l'App Store
        setTimeout(() => window.location = iosStoreURL, 1500);
      } 
      else {
        // Desktop et autres : on renvoie vers l'App Store iOS
        window.location = iosStoreURL;
      }
    }

    // Lancer la redirection automatique dès que possible
    window.addEventListener("load", redirect);

    // Lien manuel si JS est trop lent ou bloqué
    document.getElementById("manualLink").href =
      (/Android/i.test(navigator.userAgent))
        ? androidIntent
        : deepLinkURL;
  </script>
</body>
</html>
